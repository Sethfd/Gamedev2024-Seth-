<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space Game</title>
    <style>
        /* Basic reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Body setup */
        body {
            background-color: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-family: 'Press Start 2P', cursive; /* Pixel font */
            color: white;
            overflow: hidden;
        }

        /* Game container */
        #gameContainer {
            position: relative;
            width: 800px;
            height: 600px;
        }

        /* Canvas styling */
        canvas {
            background-color: transparent;
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <canvas id="gameCanvas" width="800" height="600"></canvas>
    </div>

    <script>
        // Get canvas and context
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");

        // Game settings
        const shipWidth = 64;
        const shipHeight = 64;
        let shipX = canvas.width / 2 - shipWidth / 2;
        let shipY = canvas.height - shipHeight - 10;
        let shipSpeed = 5;

        // Bullet settings
        let bullets = [];
        let bulletSpeed = 7;

        // Asteroid settings
        const asteroidWidth = 64;
        const asteroidHeight = 64;
        let asteroids = [];
        let asteroidSpeed = 2;

        // Enemy ship settings
        const enemyWidth = 64;
        const enemyHeight = 64;
        let enemies = [];
        let enemySpeed = 3;

        // Player stats
        let lives = 3;
        let score = 0;
        let isGameOver = false;
        let isPaused = false;

        // Keyboard input tracking
        let leftPressed = false;
        let rightPressed = false;
        let spacePressed = false;

        // Load images
        const shipImage = new Image();
        const asteroidImage = new Image();
        const enemyImage = new Image();

        shipImage.src = "https://github.com/Sethfd/Gamedev2024-Seth-/blob/main/PNG,S/pixil-frame-0%20(64).png?raw=true";
        asteroidImage.src = "https://github.com/Sethfd/Gamedev2024-Seth-/blob/main/PNG,S/pixil-frame-0%20(65).png?raw=true";
        enemyImage.src = "https://github.com/Sethfd/Gamedev2024-Seth-/blob/main/PNG,S/pixil-frame-0%20(66).png?raw=true";

        // Keyboard event listeners
        document.addEventListener("keydown", (e) => {
            if (e.key === "a" || e.key === "A") leftPressed = true;
            if (e.key === "d" || e.key === "D") rightPressed = true;
            if (e.key === " ") spacePressed = true;
            if (e.key === "p" || e.key === "P") togglePause(); // Pause on 'P' key
        });

        document.addEventListener("keyup", (e) => {
            if (e.key === "a" || e.key === "A") leftPressed = false;
            if (e.key === "d" || e.key === "D") rightPressed = false;
            if (e.key === " ") spacePressed = false;
        });

        // Bullet class
        class Bullet {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.width = 5;
                this.height = 10;
            }

            move() {
                this.y -= bulletSpeed;
            }

            draw() {
                ctx.fillStyle = "red";
                ctx.fillRect(this.x, this.y, this.width, this.height);
            }

            checkCollisionWithAsteroid(asteroid) {
                return this.x < asteroid.x + asteroid.width &&
                    this.x + this.width > asteroid.x &&
                    this.y < asteroid.y + asteroid.height &&
                    this.y + this.height > asteroid.y;
            }

            checkCollisionWithEnemy(enemy) {
                return this.x < enemy.x + enemy.width &&
                    this.x + this.width > enemy.x &&
                    this.y < enemy.y + enemy.height &&
                    this.y + this.height > enemy.y;
            }
        }

        // Asteroid class
        class Asteroid {
            constructor() {
                this.x = Math.random() * (canvas.width - asteroidWidth);
                this.y = -asteroidHeight;
                this.width = asteroidWidth;
                this.height = asteroidHeight;
            }

            move() {
                this.y += asteroidSpeed;
            }

            draw() {
                ctx.drawImage(asteroidImage, this.x, this.y, this.width, this.height);
            }
        }

        // Enemy class
        class Enemy {
            constructor() {
                this.x = canvas.width;
                this.y = Math.random() * (canvas.height - enemyHeight);
                this.width = enemyWidth;
                this.height = enemyHeight;
                this.speed = enemySpeed;
                this.bullets = [];
            }

            move() {
                this.x -= this.speed;
            }

            shoot() {
                if (Math.random() < 0.02) {
                    this.bullets.push(new Bullet(this.x - 10, this.y + this.height / 2));
                }

                // Move enemy bullets
                for (let bullet of this.bullets) {
                    bullet.move();
                }
            }

            draw() {
                ctx.drawImage(enemyImage, this.x, this.y, this.width, this.height);

                // Draw enemy bullets
                for (let bullet of this.bullets) {
                    bullet.draw();
                }
            }

            checkCollision(bullet) {
                return bullet.x < this.x + this.width &&
                    bullet.x + bullet.width > this.x &&
                    bullet.y < this.y + this.height &&
                    bullet.y + bullet.height > this.y;
            }
        }

        // Game loop
        function gameLoop() {
            if (isPaused) return; // Skip the game loop if paused

            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Move and draw background
            ctx.fillStyle = "#1a1a1a"; // Dark space background color
            ctx.fillRect(0, 0, canvas.width, canvas.height); // Draw the background

            // Check if game is over
            if (isGameOver) {
                displayGameOver();
                return;
            }

            // Move the spaceship
            if (leftPressed && shipX > 0) {
                shipX -= shipSpeed;
            }
            if (rightPressed && shipX + shipWidth < canvas.width) {
                shipX += shipSpeed;
            }

            // Shoot bullets
            if (spacePressed) {
                bullets.push(new Bullet(shipX + shipWidth / 2 - 2, shipY));
                spacePressed = false; // Prevent continuous shooting
            }

            // Move and draw bullets
            for (let i = 0; i < bullets.length; i++) {
                bullets[i].move();
                bullets[i].draw();

                // Remove bullet if it goes off screen
                if (bullets[i].y < 0) {
                    bullets.splice(i, 1);
                    i--; // Adjust loop index after removal
                }
            }

            // Move and draw asteroids
            for (let i = 0; i < asteroids.length; i++) {
                asteroids[i].move();
                asteroids[i].draw();

                // Check for collision with bullets
                for (let j = 0; j < bullets.length; j++) {
                    if (bullets[j].checkCollisionWithAsteroid(asteroids[i])) {
                        asteroids.splice(i, 1); // Remove asteroid
                        bullets.splice(j, 1); // Remove bullet
                        score += 10;  // Increase score
                        i--;  // Adjust loop index after removal
                        j--;  // Adjust loop index after removal
                        break; // Stop checking for other bullets once one hits
                    }
                }

                // Check for collision with player (lose a life if collision occurs)
                if (bullets[i].checkCollisionWithPlayer(shipX, shipY)) {
                    lives -= 1;  // Reduce life
                    asteroids.splice(i, 1);  // Remove asteroid
                    i--;  // Adjust loop index after removal

                    // If lives are 0, game over
                    if (lives <= 0) {
                        isGameOver = true;
                    }
                }

                // Remove asteroid if it goes off screen
                if (asteroids[i].y > canvas.height) {
                    asteroids.splice(i, 1);
                    i--;  // Adjust loop index after removal
                }
            }

            // Move and draw enemy ships
            for (let i = 0; i < enemies.length; i++) {
                enemies[i].move();
                enemies[i].shoot();
                enemies[i].draw();

                // Check for collision with player
                if (enemies[i].checkCollision(bullet)) {
                    enemies.splice(i, 1);  // Remove enemy if hit
                    score += 20;  // Increase score
                }
            }

            // Draw the spaceship
            ctx.drawImage(shipImage, shipX, shipY, shipWidth, shipHeight);

            // Display score and lives
            ctx.font = "20px Arial";
            ctx.fillStyle = "white";
            ctx.fillText("Lives: " + lives, 10, 30);
            ctx.fillText("Score: " + score, canvas.width - 100, 30);

            // Request next frame
            requestAnimationFrame(gameLoop);
        }

        // Spawn asteroids at random intervals
        function spawnAsteroids() {
            setInterval(() => {
                if (!isGameOver) {
                    asteroids.push(new Asteroid());
                }
            }, 2000);  // Spawn an asteroid every 2 seconds
        }

        // Spawn enemy ships at random intervals
        function spawnEnemies() {
            setInterval(() => {
                if (!isGameOver) {
                    enemies.push(new Enemy());
                }
            }, 4000);  // Spawn an enemy every 4 seconds
        }

        // Toggle pause state
        function togglePause() {
            isPaused = !isPaused;
            if (isPaused) {
                ctx.fillStyle = "rgba(0, 0, 0, 0.5)";
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = "white";
                ctx.font = "30px Arial";
                ctx.fillText("Paused", canvas.width / 2 - 60, canvas.height / 2 - 20);
            }
        }

        // Display game over screen
        function displayGameOver() {
            ctx.fillStyle = "rgba(0, 0, 0, 0.5)";
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = "white";
            ctx.font = "30px Arial";
            ctx.fillText("Game Over", canvas.width / 2 - 90, canvas.height / 2 - 20);
            ctx.font = "20px Arial";
            ctx.fillText("Score: " + score, canvas.width / 2 - 40, canvas.height / 2 + 20);
            ctx.fillText("Press F5 to restart", canvas.width / 2 - 80, canvas.height / 2 + 60);
        }

        // Start the game once the images are loaded
        shipImage.onload = function() {
            asteroidImage.onload = function() {
                enemyImage.onload = function() {
                    gameLoop(); // Start the game when all images are loaded
                    spawnAsteroids(); // Start spawning asteroids
                    spawnEnemies(); // Start spawning enemies
                };
            };
        };
    </script>
</body>
</html>
