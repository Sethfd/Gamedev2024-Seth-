<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Final Lair</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; margin: 50px; }
        button { padding: 10px 20px; margin: 10px; }
        .hidden { display: none; }
        #message { color: red; font-weight: bold; }
    </style>
</head>
<body>
    <h1>Welcome to The Final Lair!</h1>
    <p id="room-description">You face the ultimate challenge!</p>
    
    <div id="battle" class="hidden">
        <h2>Enemy: Dark Lord</h2>
        <p id="enemy-health">Enemy Health: 50</p>
        <p id="player-health">Your Health: 100</p>
        <button onclick="attack()">Attack</button>
        <button onclick="dodge()">Dodge</button>
        <button onclick="heal()">Heal</button>
    </div>

    <div id="message" class="hidden"></div>
    
    <button id="continue-button" class="hidden" onclick="nextRoom()">Continue</button>

    <ul>
        <li onclick="enterRoom(1)">Room 1: The Dark Entrance</li>
        <li onclick="enterRoom(2)">Room 2: The Hall of Shadows</li>
        <li onclick="enterRoom(3)">Room 3: The Throne of Despair</li>
        <li onclick="enterRoom(4)">Room 4: The Fiery Pit</li>
        <li onclick="enterRoom(5)">Room 5: The Chamber of Secrets</li>
        <li onclick="enterRoom(6)">Room 6: The Death Trap</li>
        <li onclick="enterRoom(7)">Room 7: The Hall of Whispers</li>
        <li onclick="enterRoom(8)">Room 8: The Enchanted Bridge</li>
        <li onclick="enterRoom(9)">Room 9: The Room of Trials</li>
        <li onclick="enterRoom(10)">Room 10: The Final Showdown</li>
        <li onclick="enterRoom(11)">Room 11: The Escape Route</li>
        <li onclick="enterRoom(12)">Room 12: The Twilight Realm</li>
        <li onclick="enterRoom(13)">Room 13: The Vault of Secrets</li>
        <li onclick="enterRoom(14)">Room 14: The Dark Sanctuary</li>
        <li onclick="enterRoom(15)">Room 15: The Abyss</li>
        <li onclick="enterRoom(16)">Room 16: The Hidden Path</li>
        <li onclick="enterRoom(17)">Room 17: The Lost Chamber</li>
        <li onclick="enterRoom(18)">Room 18: The Guardian's Lair</li>
        <li onclick="enterRoom(19)">Room 19: The Portal to Freedom</li>
        <li onclick="enterRoom(20)">Room 20: The Exit</li>
    </ul>

    <button id="start-fight" class="hidden" onclick="startFight()">Start Fight</button>
    <button onclick="location.href='index.html'">Back to Menu</button>

    <script>
        let playerHealth = 100;
        let enemyHealth = 50;
        let inBattle = false;

        function startFight() {
            inBattle = true;
            document.getElementById('battle').classList.remove('hidden');
            document.getElementById('start-fight').classList.add('hidden');
            document.getElementById('continue-button').classList.add('hidden');
            document.getElementById('message').classList.add('hidden');
        }

        function displayMessage(msg) {
            const messageDiv = document.getElementById('message');
            messageDiv.innerText = msg;
            messageDiv.classList.remove('hidden');
        }

        function attack() {
            const damage = Math.floor(Math.random() * 20) + 5;
            enemyHealth -= damage;
            document.getElementById('enemy-health').innerText = `Enemy Health: ${enemyHealth}`;
            displayMessage(`You dealt ${damage} damage to the enemy!`);
            if (enemyHealth <= 0) {
                displayMessage('You defeated the enemy!');
                inBattle = false;
                document.getElementById('continue-button').classList.remove('hidden');
                document.getElementById('battle').classList.add('hidden');
            } else {
                enemyAttack();
            }
        }

        function dodge() {
            displayMessage('You dodged the attack!');
            enemyAttack();
        }

        function heal() {
            const healAmount = Math.floor(Math.random() * 15) + 5;
            playerHealth = Math.min(playerHealth + healAmount, 100);
            document.getElementById('player-health').innerText = `Your Health: ${playerHealth}`;
            displayMessage(`You healed for ${healAmount} health!`);
            enemyAttack();
        }

        function enemyAttack() {
            if (inBattle) {
                const damage = Math.floor(Math.random() * 10) + 5;
                playerHealth -= damage;
                document.getElementById('player-health').innerText = `Your Health: ${playerHealth}`;
                displayMessage(`The enemy dealt ${damage} damage to you!`);
                if (playerHealth <= 0) {
                    displayMessage('You were defeated! Game Over.');
                    setTimeout(() => { location.href = 'index.html'; }, 2000);
                }
            }
        }

        function enterRoom(roomNumber) {
            if (roomNumber === 6 || roomNumber === 12) {
                trapRoomEncounter(roomNumber);
            } else {
                // If not a trap room, start a battle
                startFight();
            }
        }

        function trapRoomEncounter(roomNumber) {
            let trapDamage;
            switch (roomNumber) {
                case 6:
                    trapDamage = Math.floor(Math.random() * 20) + 10;
                    displayMessage(`You entered Room 6: The Death Trap! You took ${trapDamage} damage from a deadly trap!`);
                    break;
                case 12:
                    trapDamage = Math.floor(Math.random() * 15) + 5;
                    displayMessage(`You entered Room 12: The Twilight Realm! You took ${trapDamage} damage from a mystical trap!`);
                    break;
            }
            playerHealth -= trapDamage;
            document.getElementById('player-health').innerText = `Your Health: ${playerHealth}`;
            if (playerHealth <= 0) {
                displayMessage('You were defeated! Game Over.');
                setTimeout(() => { location.href = 'index.html'; }, 2000);
            }
        }

        function nextRoom() {
            alert('You move to the next room!');
        }
    </script>
</body>
</html>
