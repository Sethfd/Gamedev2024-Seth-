<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dungeon Crawler</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #282c34;
            color: white;
            padding: 20px;
        }
        .button {
            margin: 5px;
            padding: 10px;
            background-color: #61dafb;
            border: none;
            cursor: pointer;
        }
        #output {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>Dungeon Crawler</h1>
    <div id="output"></div>
    <div>
        <button class="button" id="moveBtn">Move</button>
        <button class="button" id="fightBtn">Fight</button>
        <button class="button" id="dodgeBtn">Dodge</button>
        <button class="button" id="searchBtn">Search</button>
        <button class="button" id="inventoryBtn">View Inventory</button>
        <button class="button" id="useItemBtn">Use Item</button>
    </div>
    <div id="inventory"></div>

    <script>
        const rooms = [];
        const searchResponses = {};
        const enemies = [
            { name: "Goblin", health: 25, minDamage: 5, maxDamage: 10 },
            { name: "Skeleton", health: 30, minDamage: 3, maxDamage: 8 },
            { name: "Zombie", health: 40, minDamage: 2, maxDamage: 5 },
            { name: "Orc", health: 50, minDamage: 6, maxDamage: 12 },
            { name: "Dragon", health: 70, minDamage: 8, maxDamage: 15 },
            { name: "Vampire", health: 35, minDamage: 5, maxDamage: 12 },
            { name: "Werewolf", health: 45, minDamage: 6, maxDamage: 14 },
            { name: "Ghost", health: 20, minDamage: 4, maxDamage: 9 },
            { name: "Mummy", health: 60, minDamage: 5, maxDamage: 11 },
            { name: "Troll", health: 80, minDamage: 7, maxDamage: 13 },
            { name: "Golem", health: 90, minDamage: 10, maxDamage: 15 },
            { name: "Fairy", health: 25, minDamage: 3, maxDamage: 7 },
            { name: "Demon", health: 100, minDamage: 12, maxDamage: 20 },
            { name: "Minotaur", health: 75, minDamage: 9, maxDamage: 16 },
            { name: "Harpy", health: 40, minDamage: 4, maxDamage: 10 },
            { name: "Banshee", health: 30, minDamage: 5, maxDamage: 8 },
            { name: "Hydra", health: 100, minDamage: 10, maxDamage: 18 },
            { name: "Phoenix", health: 60, minDamage: 8, maxDamage: 14 },
            { name: "Nymph", health: 35, minDamage: 6, maxDamage: 9 },
            { name: "Lich", health: 80, minDamage: 7, maxDamage: 15 },
            { name: "Wraith", health: 50, minDamage: 4, maxDamage: 12 }
        ];

        let currentRoom = 0;
        let playerHealth = 100;
        let monsterHealth = 0;
        let monsterName = "";
        let inCombat = false;
        let inventory = [];
        let keyFound = false; // Track if the key is found

        const usableItems = {
            "rusty sword": { type: "damage", value: 10 },
            "fireproof amulet": { type: "defense", value: 5 },
            "bubbling potion": { type: "heal", value: 20 },
            "small key": { type: "unlock", value: null },
            "mystical shield": { type: "defense", value: 15 },
            "magic orb": { type: "damage", value: 15 },
            "ancient scroll": { type: "heal", value: 30 },
            // Add more items here if needed
        };

        // Generate rooms and search responses
        for (let i = 0; i < 65; i++) {
            const roomNumber = i + 1;
            rooms.push({
                description: `You are in room ${roomNumber}. It has eerie shadows and whispers echo around.`,
                exits: [roomNumber + 1] // Connect each room linearly for simplicity
            });

            searchResponses[roomNumber] = {
                item: `item ${roomNumber}`,
                message: `You found a mysterious ${searchResponses[roomNumber].item} in this room.`
            };
        }

        function updateOutput(message) {
            const output = document.getElementById('output');
            output.innerHTML = message;
        }

        function describeRoom() {
            const room = rooms[currentRoom];
            let description = room.description + "<br>";
            description += "You can go to: " + room.exits.join(", ") + ".<br>";
            if (currentRoom === 23 && !keyFound) {
                description += "The door is locked. You need a key to enter.";
            }
            updateOutput(description);
        }

        function addItemToInventory(item) {
            inventory.push(item);
            if (item === "small key") keyFound = true; // Mark key as found
            updateOutput(`You added "${item}" to your inventory.`);
        }

        document.getElementById('moveBtn').addEventListener('click', () => {
            const room = rooms[currentRoom];
            const direction = parseInt(prompt("Which room do you want to enter? (" + room.exits.join(", ") + ")"));
            if (room.exits.includes(direction)) {
                if (direction === 23 && !keyFound) {
                    updateOutput("The door is locked. You need a key to enter.");
                } else {
                    currentRoom = direction - 1; // Update to zero-based index
                    describeRoom();
                }
            } else {
                updateOutput("You can't go that way.");
            }
        });

        document.getElementById('fightBtn').addEventListener('click', () => {
            if (currentRoom === 3 || currentRoom === 5 || currentRoom === 19 || currentRoom === 24) {
                startFight();
            } else {
                updateOutput("There is nothing to fight here.");
            }
        });

        document.getElementById('dodgeBtn').addEventListener('click', () => {
            if (inCombat) {
                dodge();
            } else {
                updateOutput("You can't dodge right now.");
            }
        });

        document.getElementById('searchBtn').addEventListener('click', () => {
            searchRoom();
        });

        document.getElementById('inventoryBtn').addEventListener('click', () => {
            viewInventory();
        });

        document.getElementById('useItemBtn').addEventListener('click', () => {
            useItem();
        });

        function searchRoom() {
            const { item, message } = searchResponses[currentRoom + 1]; // Adjust for 0-based index
            updateOutput(message);
            addItemToInventory(item);
        }

        function viewInventory() {
            if (inventory.length === 0) {
                updateOutput("Your inventory is empty.");
            } else {
                updateOutput("Inventory: " + inventory.join(", "));
            }
        }

        function startFight() {
            const randomEnemy = enemies[Math.floor(Math.random() * enemies.length)];
            monsterHealth = randomEnemy.health; // Random monster health
            monsterName = randomEnemy.name; // Set enemy name
            inCombat = true;
            updateOutput(`A ${monsterName} with ${monsterHealth} health appears!`);
            fightTurn(); // Start the turn-based battle
        }

        function fightTurn() {
            if (monsterHealth <= 0) {
                updateOutput(`You defeated the ${monsterName}!`);
                currentRoom = 1; // Return to hallway after defeating the monster
                inCombat = false;
                describeRoom();
                return;
            }

            const playerDamage = Math.floor(Math.random() * 10) + 5; // Player damage
            monsterHealth -= playerDamage;
            updateOutput(`You dealt ${playerDamage} damage to the ${monsterName}! ${monsterName}'s health: ${monsterHealth}`);

            if (monsterHealth > 0) {
                const monsterDamage = Math.floor(Math.random() * (enemies.find(e => e.name === monsterName).maxDamage - enemies.find(e => e.name === monsterName).minDamage + 1)) + enemies.find(e => e.name === monsterName).minDamage; // Monster damage
                playerHealth -= monsterDamage;
                updateOutput(`The ${monsterName} dealt ${monsterDamage} damage to you! Your health: ${playerHealth}`);

                if (playerHealth <= 0) {
                    updateOutput("You have been defeated by the monster!");
                    inCombat = false;
                } else {
                    setTimeout(() => {
                        updateOutput("It's your turn again. What will you do?");
                    }, 2000); // Proceed to next turn
                }
            } else {
                updateOutput(`You defeated the ${monsterName}!`);
                currentRoom = 1; // Return to hallway after defeating the monster
                inCombat = false;
                describeRoom();
            }
        }

        function dodge() {
            const dodgeSuccess = Math.random() < 0.5; // 50% chance to dodge
            if (dodgeSuccess) {
                updateOutput("You successfully dodged the monster's attack!");
                return; // Skip the monster's attack
            } else {
                const monsterDamage = Math.floor(Math.random() * (enemies.find(e => e.name === monsterName).maxDamage - enemies.find(e => e.name === monsterName).minDamage + 1)) + enemies.find(e => e.name === monsterName).minDamage; // Monster damage
                playerHealth -= monsterDamage;
                updateOutput(`You failed to dodge! The ${monsterName} dealt ${monsterDamage} damage to you! Your health: ${playerHealth}`);
                if (playerHealth <= 0) {
                    updateOutput("You have been defeated by the monster!");
                    inCombat = false;
                } else {
                    fightTurn(); // Proceed to next turn
                }
            }
        }

        function useItem() {
            if (inventory.length === 0) {
                updateOutput("Your inventory is empty. You have no items to use.");
                return;
            }

            const itemToUse = prompt("Which item do you want to use? (" + inventory.join(", ") + ")");
            if (inventory.includes(itemToUse) && usableItems[itemToUse]) {
                const item = usableItems[itemToUse];
                if (item.type === "damage") {
                    monsterHealth -= item.value;
                    updateOutput(`You used ${itemToUse} and dealt ${item.value} damage! ${monsterName}'s health: ${monsterHealth}`);
                } else if (item.type === "heal") {
                    playerHealth += item.value;
                    updateOutput(`You used ${itemToUse} and healed ${item.value} health! Your health: ${playerHealth}`);
                } else if (item.type === "defense") {
                    updateOutput(`You used ${itemToUse}, increasing your defense by ${item.value}.`);
                    // Implement defense logic if desired
                } else if (item.type === "unlock") {
                    if (itemToUse === "small key") {
                        if (currentRoom === 23) { // Unlock the door
                            updateOutput("You used the key to unlock the door. It creaks open.");
                            currentRoom = 24; // Move to the next room after unlocking
                            describeRoom();
                        } else {
                            updateOutput("You can only use the key at the locked door.");
                        }
                    }
                }
                inventory = inventory.filter(i => i !== itemToUse); // Remove used item
            } else {
                updateOutput("You can't use that item.");
            }
        }

        describeRoom(); // Initial room description
    </script>
</body>
</html>

