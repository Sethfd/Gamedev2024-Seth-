<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Single Room Dungeon Explorer</title>
    <style>
        body {
            background-color: #222;
            color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            font-family: Arial, sans-serif;
            overflow: hidden;
        }
        canvas {
            border: 2px solid #fff;
        }
        #message {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px;
            border-radius: 5px;
        }
    </style>
</head>
<body>

<canvas id="dungeonCanvas"></canvas>
<div id="message"></div>

<script>
    const canvas = document.getElementById('dungeonCanvas');
    const ctx = canvas.getContext('2d');
    const messageDiv = document.getElementById('message');

    const dungeon = [
        [1, 1, 1, 1, 1, 1, 1, 1], // Wall
        [1, 1, 1, 0, 0, 1, 1, 1], // Room with door
        [1, 0, 2, 0, 0, 2, 0, 1], // Room with key
        [1, 0, 1, 0, 0, 1, 1, 1], // Wall with locked door
        [1, 0, 2, 0, 0, 2, 0, 1], // Wall
        [1, 1, 1, 0, 0, 1, 1, 1], // Key
        [1, 9, 2, 0, 0, 2, 0, 1], // Locked door
        [1, 1, 1, 0, 0, 1, 1, 1], // Wall
        [1, 0, 2, 0, 0, 2, 0, 1], // Path
        [0, 0, 1, 1, 3, 1, 1, 1]  // Exit
    ];
    
    const width = dungeon[0].length; 
    const height = dungeon.length; 
    let hasKey = false; 
    let gameOver = false; 
    let won = false; 

    function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        drawDungeon();
    }

    let playerPos = { x: 1, y: 1 }; // Starting position

    function drawDungeon() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        const cellWidth = canvas.width / width;
        const cellHeight = canvas.height / height;

        for (let y = 0; y < dungeon.length; y++) {
            for (let x = 0; x < dungeon[y].length; x++) {
                switch (dungeon[y][x]) {
                    case 1: ctx.fillStyle = '#555'; break; // Wall
                    case 0: ctx.fillStyle = '#222'; break; // Path
                    case 2: ctx.fillStyle = '#8B4513'; break; // Door
                    case 3: ctx.fillStyle = '#FF0000'; break; // Locked door
                    case 9: ctx.fillStyle = '#FFFF00'; break; // Key
                }
                ctx.fillRect(x * cellWidth, y * cellHeight, cellWidth, cellHeight);
            }
        }
        ctx.fillStyle = '#FFFFFF'; 
        ctx.fillRect(playerPos.x * cellWidth, playerPos.y * cellHeight, cellWidth, cellHeight);

        if (gameOver) {
            ctx.fillStyle = 'rgba(255, 0, 0, 0.7)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '30px Arial';
            ctx.fillText("Game Over", canvas.width / 2 - 70, canvas.height / 2);
        }

        if (won) {
            ctx.fillStyle = 'rgba(0, 255, 0, 0.7)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '30px Arial';
            ctx.fillText("You Win!", canvas.width / 2 - 60, canvas.height / 2);
        }
    }

    function displayMessage(msg) {
        messageDiv.textContent = msg;
        setTimeout(() => messageDiv.textContent = '', 2000);
    }

    function isValidMove(pos) {
        return pos.x >= 0 && pos.x < width && pos.y >= 0 && pos.y < height && dungeon[pos.y][pos.x] !== 1;
    }

    function saveGame() {
        const gameState = {
            playerPos,
            hasKey,
            gameOver,
            won
        };
        localStorage.setItem('dungeonGame', JSON.stringify(gameState));
        displayMessage("Game Saved!");
    }

    function loadGame() {
        const savedState = localStorage.getItem('dungeonGame');
        if (savedState) {
            const gameState = JSON.parse(savedState);
            playerPos = gameState.playerPos;
            hasKey = gameState.hasKey;
            gameOver = gameState.gameOver;
            won = gameState.won;
            displayMessage("Game Loaded!");
        } else {
            displayMessage("No saved game found.");
        }
    }

    window.addEventListener('keydown', (event) => {
        if (gameOver || won) return;

        let newPos = { x: playerPos.x, y: playerPos.y };

        if (event.key === 'z') {
            saveGame();
            return;
        } else if (event.key === 'l') {
            loadGame();
            return;
        }

        if (event.key === 'w') newPos.y--;
        else if (event.key === 's') newPos.y++;
        else if (event.key === 'a') newPos.x--;
        else if (event.key === 'd') newPos.x++;

        if (isValidMove(newPos)) {
            playerPos = newPos;
            if (dungeon[playerPos.y][playerPos.x] === 2) {
                displayMessage("You found a door!");
            } else if (dungeon[playerPos.y][playerPos.x] === 3) {
                if (hasKey) {
                    won = true;
                    displayMessage("The door is unlocked! You win!");
                } else {
                    gameOver = true;
                    displayMessage("The door is locked! You need a key.");
                }
            } else if (dungeon[playerPos.y][playerPos.x] === 9) {
                hasKey = true;
                displayMessage("You found a key!");
                dungeon[playerPos.y][playerPos.x] = 0; // Remove key from the dungeon
            }
        } else {
            displayMessage("You hit a wall!");
        }

        drawDungeon();
    });

    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();
</script>

</body>
</html>
